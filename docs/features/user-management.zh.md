# 用户管理

## 概述

Website Defender 提供完整的用户管理功能，支持通过管理后台或 API 进行用户的增删改查操作。

## 用户增删改查

通过管理后台，您可以：

- **创建用户**：添加新的管理员用户
- **编辑用户**：修改用户信息、密码和权限
- **删除用户**：移除不再需要的用户
- **查看用户列表**：浏览所有已注册的用户

## 角色控制

每个用户拥有一个**管理员权限标识**：

- **管理员**：拥有完整的管理后台访问权限，可管理用户、IP 名单、WAF 规则等所有功能。管理员始终跳过[域名作用域](domain-scopes.md)检查。
- **普通用户**：仅拥有认证通过后的访问权限，受域名作用域限制。

!!! info "默认用户"
    首次启动时，系统会自动创建默认管理员用户（默认用户名和密码均为 `defender`）。请在首次登录后立即修改密码。

## Git Token 生成

为每个用户生成用于机器访问的 Git Token：

- 在用户管理页面一键生成 Git Token
- Token 格式为 `username:token`
- 支持一键复制到剪贴板
- 通过 `Defender-Git-Token` 请求头使用（请求头名称可配置）
- Git Token 支持[域名作用域](domain-scopes.md)检查

!!! tip "使用场景"
    Git Token 适合用于 CI/CD 管道、自动化脚本、Git 客户端等需要非交互式认证的场景。

## 域名作用域

为每个用户配置可访问的受保护域名：

- 使用逗号分隔的域名模式（如 `gitea.com, *.internal.org`）
- 支持精确匹配和通配符匹配
- 作用域为空表示不限制访问
- 管理员用户始终跳过作用域检查

详细说明请参阅[域名作用域](domain-scopes.md)。

## 许可证管理

许可证令牌为 API 和机器访问提供简化的认证方式。

### 生成许可证

1. 登录管理后台
2. 进入**许可证管理**页面
3. 点击生成新的许可证令牌

### 安全存储

!!! warning "一次性显示"
    许可证令牌**仅在生成时显示一次**，请务必在生成后立即复制并妥善保存。系统仅存储令牌的 SHA-256 哈希值，无法恢复原始令牌。

### 管理操作

- **激活/吊销**：通过管理后台切换许可证的激活状态
- **删除**：永久删除不再需要的许可证
- 已吊销的许可证将无法通过认证

## API 管理

用户管理也可以通过 REST API 完成：

| 方法 | 路径 | 说明 |
|------|------|------|
| `POST` | `/users` | 创建用户 |
| `GET` | `/users` | 查询用户列表 |
| `PUT` | `/users/:id` | 更新用户信息 |
| `DELETE` | `/users/:id` | 删除用户 |
| `POST` | `/licenses` | 创建许可证 |
| `GET` | `/licenses` | 查询许可证列表 |
| `DELETE` | `/licenses/:id` | 删除许可证 |

详见 [API 参考](../api-reference/index.md)。

---

## 相关页面

- [认证与访问控制](authentication.md) - 各种认证方式详解
- [域名作用域](domain-scopes.md) - 多租户访问控制
- [API 参考](../api-reference/index.md) - 完整的 API 接口文档
